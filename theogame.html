<!DOCTYPE html>
<html lang="he">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>转驻住 转 '拽 驻</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            /* 注  */
            font-family: 'Arial', 'Helvetica Neue', Helvetica, sans-serif;
            /* 驻 拽专 住专 */
            background-color: #f0f0f0;
            /* 专拽注  */
            direction: rtl;
            /*  拽住  砖 */
        }

        #gameArea {
            position: relative;
            width: 100vw;
            /* 专 住  */
            height: 100vh;
            /*  住  */
            /* 专拽注 砖驻专: 专 砖 注 */
            background: linear-gradient(to bottom, #87CEEB 0%, #add8e6 100%);
            /* 转转 专  转专 */
            overflow: hidden;
            /* 住转专 拽 砖爪 转 */
            cursor: none;
            /* 住转专 转 住 注专 专 注 专 砖拽 */
        }

        #player {
            position: absolute;
            /* --- 砖: 转 砖拽 --- */
            width: 110px;
            /*  */
            height: 85px;
            /*  */
            /* -------------------------- */
            bottom: 15px;
            /* 专 拽 拽爪 */
            left: 50%;
            transform: translateX(-50%);
            /* 拽 拽 爪注 */
            /* --- === 祝 转 === --- */
            /* 砖 转 'theoface.png' 砖 拽抓 转 砖 (专爪 PNG 注 专拽注 砖拽祝) */
            background-image: url('theoface.png');
            /* --- ================== --- */
            background-size: contain;
            /*  砖转 转转  砖拽注 */
            background-repeat: no-repeat;
            background-position: center;
            z-index: 10;
            /* 注 拽 驻 */
            transition: left 0.05s linear;
            /* 转注 拽 转专 砖拽 (驻爪) */
        }

        .fallingObject {
            position: absolute;
            /* --- 砖: 转 拽 --- */
            width: 50px;
            /*  */
            height: 50px;
            /*  */
            font-size: 50px;
            /*  -  ' */
            line-height: 50px;
            /*  - 拽 转 ' 转 */
            /* -------------------------------- */
            text-align: center;
            user-select: none;
            /* 注 专 砖 拽住 */
            z-index: 5;
            /* 住驻转 爪 拽  */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        #score,
        #timer {
            /* 注爪 砖转祝 拽 专 */
            position: absolute;
            top: 15px;
            font-size: 28px;
            /*  */
            color: white;
            text-shadow: 2px 2px 4px black;
            /* 爪  转专 */
            z-index: 20;
            background-color: rgba(0, 0, 0, 0.2);
            /* 专拽注 砖拽祝 拽  */
            padding: 5px 10px;
            border-radius: 8px;
        }

        #score {
            right: 15px;
            /* 砖专   direction: rtl */
        }

        /* --- 住驻: 注爪 专 --- */
        #timer {
            left: 15px;
            /* 砖专 砖 */
        }

        /* --------------------------- */

        /* 砖: 注爪 砖驻专 专转 住祝 砖拽 */
        .overlayMessage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 22px;
            /*  */
            color: #333;
            /* 爪注 拽住  转专 */
            background-color: rgba(255, 255, 255, 0.9);
            /* 专拽注  砖拽祝 转专 */
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            /* 爪 专 "爪祝" */
            text-align: center;
            z-index: 30;
            display: block;
            /* 专专转   */
        }

        #gameOver {
            display: none;
            /* 转 住转专 */
        }

        .overlayMessage br {
            margin-bottom: 10px;
            /* 专  砖专转 注转 */
        }

        .overlayMessage span {
            /* 住 砖转 拽 住驻 */
            font-weight: bold;
            font-size: 1.2em;
            color: #007bff;
            /* 爪注  */
        }
    </style>
</head>

<body>

    <div id="gameArea">
        <div id="player"></div>
        <div id="score">拽: 0</div>
        <div id="timer">: 60</div>
        <div id="instructions" class="overlayMessage">
            <h2>转驻住 转 '拽 驻!</h2>
             转 爪注  注专  转驻住 <br>
            注 -ウ<br><br>
            <strong>注 住/抓  转!</strong>
        </div>
        <div id="gameOver" class="overlayMessage">
            <h2> 专!</h2>
            拽 住驻: <span id="finalScore">0</span><br><br>
            <strong>注 住/抓  砖拽 砖!</strong>
        </div>
    </div>

    <audio id="eatingSound" src="Cartoon Eating Sound Effect _ Non Copyrighted _ PP Technical (1).mp3"
        preload="auto"></audio>

    <script>
        const gameArea = document.getElementById('gameArea');
        const player = document.getElementById('player');
        const scoreDisplay = document.getElementById('score');
        const instructions = document.getElementById('instructions');
        const eatingSound = document.getElementById('eatingSound');
        const timerDisplay = document.getElementById('timer');
        const gameOverScreen = document.getElementById('gameOver');
        const finalScoreDisplay = document.getElementById('finalScore');

        let score = 0;
        let spawnInterval;
        let fallingObjects = [];
        let gameActive = false;

        const GAME_DURATION = 60; // 砖转
        let timeLeft = GAME_DURATION;
        let timerInterval;

        const objectBaseSpeed = 3.5;
        const spawnRate = 750;

        const junkFood = ['', '', '', '', '', '', '', '', '', ''];
        const healthyFood = ['', 'ウ', '', '', '', 'ガ', '', '', '', ''];

        function updateScore(change) {
            score += change;
            scoreDisplay.textContent = `拽: ${score}`;
        }

        function getRandomFood() {
            const isJunk = Math.random() < 0.65;
            const foodList = isJunk ? junkFood : healthyFood;
            const emoji = foodList[Math.floor(Math.random() * foodList.length)];
            return {
                emoji: emoji,
                type: isJunk ? 'junk' : 'healthy'
            };
        }

        function spawnObject() {
            if (!gameActive) return;

            const food = getRandomFood();
            const obj = document.createElement('div');
            obj.classList.add('fallingObject');
            obj.textContent = food.emoji;
            obj.dataset.type = food.type;

            // 拽转 专 -CSS  砖砖 专专转  - 砖 拽
            const computedStyle = window.getComputedStyle(obj);
            const objectWidth = parseInt(computedStyle.width) || 50;

            const maxLeft = gameArea.offsetWidth - objectWidth;
            obj.style.left = Math.random() * maxLeft + 'px';
            obj.style.top = '-60px';

            obj.dataset.speed = objectBaseSpeed + Math.random() * 2.5;

            gameArea.appendChild(obj);
            fallingObjects.push(obj);
        }

        function movePlayer(event) {
            if (!gameActive) return;

            let targetX;
            if (event.touches) {
                targetX = event.touches[0].clientX;
            } else {
                targetX = event.clientX;
            }

            const gameAreaRect = gameArea.getBoundingClientRect();
            const playerWidth = player.offsetWidth;
            let newLeft = targetX - gameAreaRect.left - (playerWidth / 2);

            const minLeft = 0;
            const maxLeft = gameArea.offsetWidth - playerWidth;
            newLeft = Math.max(minLeft, Math.min(newLeft, maxLeft));

            player.style.left = newLeft + 'px';
        }


        function checkCollision(obj) {
            const objRect = obj.getBoundingClientRect();
            const playerRect = player.getBoundingClientRect();

            return (
                objRect.bottom >= playerRect.top + 10 &&
                objRect.top <= playerRect.bottom - 10 &&
                objRect.right >= playerRect.left + 10 &&
                objRect.left <= playerRect.right - 10
            );
        }

        // --- 砖 专: 驻砖 驻拽爪转  住 ---
        function playEatingSound() {
            if (eatingSound) { // 拽 专拽   拽
                // 住 拽 驻住 转 ,  .
                eatingSound.currentTime = 0; // 专 转 - 砖!
                eatingSound.play().catch(e => {
                    // 专砖 砖 拽住   砖,   注爪专 转 砖拽.
                    console.error("砖  爪 :", e);
                });
            }
        }
        // -----------------------------------------------

        function gameLoop() {
            if (!gameActive) return;

            fallingObjects = fallingObjects.filter(obj => {
                let currentTop = parseFloat(obj.style.top || 0);
                let speed = parseFloat(obj.dataset.speed || objectBaseSpeed);
                obj.style.top = currentTop + speed + 'px';

                // 拽转 转砖转
                if (checkCollision(obj)) {
                    // --- 拽专 驻拽爪 砖驻专转 ---
                    playEatingSound();
                    // --------------------------------

                    if (obj.dataset.type === 'junk') {
                        updateScore(10);
                    } else {
                        updateScore(-5);
                    }
                    obj.remove();
                    return false; // 住专 注专
                }

                // 拽  爪  转转
                if (currentTop > gameArea.offsetHeight) {
                    obj.remove();
                    return false; // 住专 注专
                }

                return true; // 砖专 砖拽
            });

            // 拽砖 转 驻专 
            requestAnimationFrame(gameLoop);
        }

        function updateTimer() {
            timeLeft--;
            timerDisplay.textContent = `: ${timeLeft}`;

            if (timeLeft <= 0) {
                endGame();
            }
        }

        function endGame() {
            gameActive = false;
            clearInterval(spawnInterval);
            clearInterval(timerInterval);

            fallingObjects.forEach(obj => obj.remove());
            fallingObjects = [];

            finalScoreDisplay.textContent = score;
            gameOverScreen.style.display = 'block';
            instructions.style.display = 'none';
        }

        function startGame() {
            if (gameActive) return;

            gameActive = true;
            instructions.style.display = 'none';
            gameOverScreen.style.display = 'none';
            score = 0;
            updateScore(0);

            timeLeft = GAME_DURATION;
            timerDisplay.textContent = `: ${timeLeft}`;
            clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 1000);

            fallingObjects.forEach(obj => obj.remove());
            fallingObjects = [];

            requestAnimationFrame(gameLoop);

            clearInterval(spawnInterval);
            spawnInterval = setInterval(spawnObject, spawnRate);

            setTimeout(spawnObject, 100);
        }

        const startOrRestartHandler = () => {
            if (!gameActive) {
                if (eatingSound && eatingSound.paused) {
                    eatingSound.play().then(() => {
                        eatingSound.pause();
                        eatingSound.currentTime = 0;
                    }).catch(e => { });
                }
                startGame();
            }
        };

        gameArea.addEventListener('mousemove', movePlayer);
        gameArea.addEventListener('touchmove', function (event) {
            event.preventDefault();
            movePlayer(event);
        }, { passive: false });

        gameArea.addEventListener('mousedown', startOrRestartHandler);
        gameArea.addEventListener('touchstart', startOrRestartHandler);

    </script>

</body>

</html>